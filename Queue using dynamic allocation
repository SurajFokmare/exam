#include <stdio.h>
#include <stdlib.h>

struct Node { int data; struct Node *next; };
struct Node *front = NULL, *rear = NULL;

void enqueue(int x){
    struct Node *n = malloc(sizeof(struct Node));
    n->data = x; n->next = NULL;
    if(!rear) front = rear = n;
    else { rear->next = n; rear = n; }
}

int dequeue(){
    if(!front){ printf("Queue Underflow\n"); return -1; }
    int val = front->data;
    struct Node *tmp = front; front = front->next;
    if(!front) rear = NULL;
    free(tmp);
    return val;
}

void display(){
    if(!front){ printf("[ empty ]\n"); return; }
    printf("Queue (front->rear): ");
    for(struct Node *p = front; p; p = p->next) printf("%d ", p->data);
    printf("\n");
}

int main(){
    enqueue(1); enqueue(2); enqueue(3);
    printf("After enqueue 1,2,3:\n"); display();
    printf("Dequeued: %d\n", dequeue());
    printf("After dequeuing one:\n"); display();

    // free rest
    while(front) dequeue();
    return 0;
}
